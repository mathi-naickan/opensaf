#!/bin/sh

osafdirfile=@sysconfdir@/@PACKAGE_NAME@/osafdir.conf
prog="osafdtmd"

# Source LSB functions library
. /lib/lsb/init-functions


if [ ! -r $osafdirfile ]; then
	logger -s -t $prog "can't read $osafdirfile, exiting."
	exit 6
else
	. $osafdirfile
fi

pidval=`cat $pkgpiddir/$prog.pid`
while true
do
	if ! test -d /proc/$pidval ; then
		logger -s -t $prog "$prog Process down, Rebooting the node"
		$pkglibdir/opensaf_reboot 0
		exit 0
	fi
	sleep 1
done


